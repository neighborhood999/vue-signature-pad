"use strict";function _interopDefault(e){return e&&"object"==typeof e&&"default"in e?e.default:e}var SignaturePad=_interopDefault(require("signature_pad")),mergeImages=_interopDefault(require("merge-images")),SAVE_TYPE=["image/png","image/jpeg","image/svg+xml"],checkSaveType=function(e){return SAVE_TYPE.includes(e)},DEFAULT_OPTIONS={minWidth:.5,maxWidth:2.5,throttle:16,minDistance:5,backgroundColor:"rgba(0,0,0,0)",penColor:"black",velocityFilterWeight:.7},convert2NonReactive=function(e){return JSON.parse(JSON.stringify(e))},TRANSPARENT_PNG={src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mNkYAAAAAYAAjCB0C8AAAAASUVORK5CYII=",x:0,y:0},VueSignaturePad={name:"VueSignaturePad",props:{width:{type:String,default:"100%"},height:{type:String,default:"100%"},customStyle:{type:Object},saveType:{type:String,default:"image/png"},options:{type:Object,default:function(){return{}}},images:{type:Array,default:function(){return[]}}},data:function(){return{signaturePad:{},cacheImages:[],signatureData:TRANSPARENT_PNG}},mounted:function(){var e=this.options,t=this.$refs.signaturePadCanvas,a=new SignaturePad(t,Object.assign({},DEFAULT_OPTIONS,e));this.signaturePad=a,window.addEventListener("resize",this.resizeCanvas.bind(this,t),!1),this.resizeCanvas(t)},methods:{resizeCanvas:function(e){var t=Math.max(window.devicePixelRatio||1,1);e.width=e.offsetWidth*t,e.height=e.offsetHeight*t,e.getContext("2d").scale(t,t),this.signaturePad.clear(),this.signatureData=TRANSPARENT_PNG},saveSignature:function(){var e=this.signaturePad,t=this.saveType,a={isEmpty:!1,data:void 0};if(!checkSaveType(t))throw new Error("Image type is incorrect!");return e.isEmpty()?Object.assign({},a,{isEmpty:!0}):(this.signatureData=e.toDataURL(t),Object.assign({},a,{data:this.signatureData}))},undoSignature:function(){var e=this.signaturePad,t=e.toData();if(t)return e.fromData(t.slice(0,-1))},mergeImageAndSignature:function(e){return this.signatureData=e,mergeImages(this.images.concat(this.cacheImages,[this.signatureData]))},addImages:function(e){return void 0===e&&(e=[]),this.cacheImages=this.cacheImages.concat(e),mergeImages(this.images.concat(this.cacheImages,[this.signatureData]))},lockSignaturePad:function(){return this.signaturePad.off()},openSignaturePad:function(){return this.signaturePad.on()},getPropImagesAndCacheImages:function(){return this.propsImagesAndCustomImages},clearCacheImages:function(){this.cacheImages=[]}},computed:{propsImagesAndCustomImages:function(){var e=convert2NonReactive(this.images),t=convert2NonReactive(this.cacheImages);return e.concat(t)}},render:function(e){var t=this.width,a=this.height,i=this.customStyle;return e("div",{style:Object.assign({},{width:t,height:a},i)},[e("canvas",{style:{width:"100%",height:"100%"},ref:"signaturePadCanvas"})])},install:function(e){return e.component(VueSignaturePad.name,VueSignaturePad)}};"undefined"!=typeof window&&window.Vue&&window.Vue.use(VueSignaturePad),module.exports=VueSignaturePad;
